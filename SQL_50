SQL 50 questions 

'SELECT'

1757. Recyclable and low fat products

    select product_id
    from products
    where low_fats = 'Y' and recyclable = 'Y';


584. Find customer referee

    select name
    from customer
    where referee_id != 2 or referee_id is null;


595. Big Countries

    select name, population, area
    from World
    where area >= 3000000 or population >= 25000000;

1148. Article Views I

    select distinct author_id as id
    from views
    where author_id = viewer_id
    order by author_id;


1683. Invalid Tweets

    select tweet_id
    from tweets
    where length(content) > 15;



'BASIC JOINS'

1378. Replace Employee ID With The Unique Identifier

    select unique_id, e.name
    from employees e
    left join employeeuni u
    using (id);

1068. Product Sales Analysis I

    select product_name, year, price
    from sales s
    join product p using (product_id);

1581. Customer Who Visited but Did Not Make Any Transactions

    select customer_id, count(*) as count_no_trans
    from visits v
    left join transactions t
    using (visit_id)
    where transaction_id is null
    group by customer_id;

197. Rising Temperature

    select w1.Id
    from weather w1
    join weather w2
    where datediff(w1.recordDate,w2.recordDate) = 1 and w1.temperature > w2.temperature;

1661. Average Time of Process per Machine

    select a.machine_id, round(avg(b.timestamp - a.timestamp),3) as processing_time
    from activity a
    join activity b
    where a.machine_id = b.machine_id and a.process_id = b.process_id 
    and a.activity_type = 'start' and b.activity_type = 'end' 
    group by a.machine_id;

577. Employee Bonus

    select name, bonus
    from employee e
    left join bonus b using(empid)
    where bonus < 1000 or bonus is null;

1280. Students and Examinations

    select s.student_id, s.student_name, sb.subject_name, count(e.student_id) as attended_exams
    from students s
    join subjects sb
    left join examinations e
    on s.student_id = e.student_id
    and e.subject_name = sb.subject_name
    group by s.student_id, s.student_name, sb.subject_name
    order by s.student_id, sb.subject_name;

570. Managers with at Least 5 Direct Reports

    select e.name
    from employee e
    join employee m
    on e.id = m.managerId
    group by e.id
    having count(m.managerId) >= 5;

1934. Confirmation Rate

    select s.user_id, ifnull(round(sum(action = 'confirmed')/ count(*),2),0) as confirmation_rate
    from signups s
    left join confirmations c using (user_id)
    group by user_id;



'BASIC AGGREGATE FUNCTIONS'
